version: 1
default_environment: dev
project_id: ede9e065-420d-4de0-a255-7d6677bf8c4c

plugins:
  extractors:
    - name: tap-mssql
      variant: buzzcutnorman
      pip_url: git+https://github.com/BuzzCutNorman/tap-mssql.git
      config:
        host: ${TAP_MSSQL_HOST}
        port: ${TAP_MSSQL_PORT}
        user: ${TAP_MSSQL_USER}
        password: ${TAP_MSSQL_PASSWORD}
        database: ${TAP_MSSQL_DATABASE}
        schema: dbo
      select:
        - dbo-F_ECRITUREC.*
        - dbo-F_ECRITUREA.*
   
  loaders:
    - name: target-bigquery
      variant: z3z1ma
      pip_url: git+https://github.com/z3z1ma/target-bigquery.git
      config:
        method: storage_write_api
        denormalized: true
        project: ${TARGET_BIGQUERY_PROJECT}
        location: ${TARGET_BIGQUERY_LOCATION}
        credentials_path: ${TARGET_BIGQUERY_CREDENTIALS_PATH}
        dataset: ${TARGET_BIGQUERY_DATASET_RAW}
        overwrite: true
        column_name_transforms:
          snake_case: true
          replace_period_with_underscore: true
          add_underscore_when_invalid: true

environments:
  - name: dev
    config:
      plugins:
        loaders:
          - name: target-bigquery
            config:
              dataset: ${TARGET_BIGQUERY_DATASET_RAW_DEV}

  - name: prod
    config:
      plugins:
        loaders:
          - name: target-bigquery
            config:
              dataset: ${TARGET_BIGQUERY_DATASET_RAW_PROD}